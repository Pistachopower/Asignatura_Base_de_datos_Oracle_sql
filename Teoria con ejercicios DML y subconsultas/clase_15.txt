SELECT *
from empleados
where (depart =50 or depart = 52)
and hijos >=1;

SELECT *
from empleados
where depart in (50,52)
and hijos >=1;

SELECT *
from empleados
where extras = 0;


--18. Mostrar el código de los pedidos donde se haya vendido el producto de la gama ‘Aromáticas’ mas caro.
SELECT MAX(DP.PRECIOUNIDAD)
FROM DETALLEPEDIDOS DP, PRODUCTOS PR
WHERE DP.CODIGOPRODUCTO = PR.CODIGOPRODUCTO
AND UPPER(PR.GAMA) = 'AROMÁTICAS';



SELECT DP.CODIGOPEDIDO
FROM DETALLEPEDIDOS DP, PRODUCTOS PR
WHERE DP.CODIGOPRODUCTO = PR.CODIGOPRODUCTO
AND UPPER(PR.GAMA) = 'AROMÁTICAS'
AND DP.PRECIOUNIDAD = (SELECT MAX(DP.PRECIOUNIDAD)
                        FROM DETALLEPEDIDOS DP, PRODUCTOS PR
                        WHERE DP.CODIGOPRODUCTO = PR.CODIGOPRODUCTO
                        AND UPPER(PR.GAMA) = 'AROMÁTICAS'
                       );


---- Actualizar el limite de crédito a lo que se ha gastado cada cliente.
SELECT NVL(SUM(DP.PRECIOUNIDAD*DP.CANTIDAD),0)
FROM PEDIDOS P, DETALLEPEDIDOS DP
WHERE DP.CODIGOPEDIDO = P.CODIGOPEDIDO
AND P.CODIGOCLIENTE = 2;-- CAMBIANDO EL 1 POR CADA CODIGO DE CLIENTE TENDRIAMOS LA SOLUCION


UPDATE CLIENTES C
  SET C.LIMITECREDITO = (SELECT NVL(SUM(DP.PRECIOUNIDAD*DP.CANTIDAD),0)
                            FROM PEDIDOS P, DETALLEPEDIDOS DP
                            WHERE DP.CODIGOPEDIDO = P.CODIGOPEDIDO
                            AND P.CODIGOCLIENTE = C.CODIGOCLIENTE);

-- CUANTO SE HA GASTADO CADA CLIENTE
SELECT C.CODIGOCLIENTE,c.nombrecliente, (SELECT NVL(SUM(DP.PRECIOUNIDAD*DP.CANTIDAD),0)
                                        FROM PEDIDOS P, DETALLEPEDIDOS DP
                                        WHERE DP.CODIGOPEDIDO = P.CODIGOPEDIDO
                                        AND P.CODIGOCLIENTE = C.CODIGOCLIENTE) AS GASTADO
FROM CLIENTES C;

-- DEVUELVE UN LISTADO DE LAS DIFERENTE GAMAS DE PRODUCTO QUE HA COMPRADO CADA CLIENTE
SELECT DISTINCT C.NOMBRECLIENTE,  PR.GAMA
FROM PRODUCTOS PR, DETALLEPEDIDOS DP, PEDIDOS P, CLIENTES C
WHERE PR.CODIGOPRODUCTO = DP.CODIGOPRODUCTO
AND DP.CODIGOPEDIDO = P.CODIGOPEDIDO
AND P.CODIGOCLIENTE = C.CODIGOCLIENTE;
