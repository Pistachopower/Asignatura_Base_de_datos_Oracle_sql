/************** Otra forma de hacer consultas ********************************/
-- CONSULTAS CON INNER JOIN
SELECT *
FROM DEPT D, EMP E
WHERE D.DEPTNO = E.DEPTNO
AND UPPER(D.DNAME) LIKE '%E%';

--
SELECT *
FROM DEPT D INNER JOIN EMP E ON D.DEPTNO  = E.DEPTNO
WHERE UPPER(D.DNAME) LIKE '%E%';

--OBTENER LOS DATOS DE LOS DEPT QUE NO TIENEN EMPLEADOS

-- MI OBJETIVO ES OBTENER UN LISTADOS DE TOOOOOODDOOOOS LOS DEPARTAMENTO CON SU NUMERO DE EMPLEADOS---> OPERATIONS TIENE QUE TENER UN CERO.
SELECT D.DNAME, COUNT(E.EMPNO)
FROM DEPT D, EMP E
WHERE D.DEPTNO = E.DEPTNO
GROUP BY D.DNAME
UNION
SELECT DNAME ,0
FROM DEPT
WHERE DEPTNO NOT IN (SELECT DEPTNO FROM EMP);

-- PERO ES ALGO RUDIMENTARIO, EN DEFINITIVA LE DOY PRIORIDAD A LAS TABLAS PADRES PARA OBTENER LOS DATOS
-- PARA HACER ESTO DE UNA FORMA MÁS ELEGANTE UTILIZO LO QUE SE CONOCE COMO OUTER JOIN
SELECT D.DNAME, E.ENAME
FROM DEPT D, EMP E
WHERE D.DEPTNO = E.DEPTNO(+);
--- CON EL MAS LE DOY PRIORIDAD A LA TABLA EN LA CUAL NO HE PUESTO EL MÁS.(+)
-- VOLVIENDO A CONTAR A LOS EMPLEADOS TENEMOS
SELECT D.DNAME, COUNT(E.EMPNO)
FROM DEPT D, EMP E
WHERE D.DEPTNO = E.DEPTNO(+)
GROUP BY D.DNAME;


-- EN OTRA LITERATURAS ESTO SE CONOCOCE COMO LEFT JOIN O RIGHT JOIN
--LEFT JOIN
SELECT *
FROM DEPT D LEFT JOIN EMP E ON D.DEPTNO  = E.DEPTNO;

SELECT *
FROM EMP E, DEPT D
WHERE D.DEPTNO  = E.DEPTNO(+);

SELECT D.DNAME, COUNT(EMPNO)
FROM EMP E, DEPT D
WHERE D.DEPTNO  = E.DEPTNO(+)
GROUP BY D.DNAME;

--EL RIGHT 
SELECT *
FROM DEPT D RIGHT JOIN EMP E ON D.DEPTNO  = E.DEPTNO;
--ES LO MISMO QUE PONER LE MAS ES EN OTRO SITIO
SELECT *
FROM EMP E, DEPT D
WHERE D.DEPTNO(+)  = E.DEPTNO;

--- BASIC QUESTIONS BY NELSON
--SEGUNDOS DEL DIA
SELECT TO_CHAR(SYSDATE,'HH24'),TO_CHAR(SYSDATE,'MI'),TO_CHAR(SYSDATE,'SS'),
       TO_NUMBER(TO_CHAR(SYSDATE,'HH24'))*3600+ TO_NUMBER(TO_CHAR(SYSDATE,'MI'))*60+TO_NUMBER(TO_CHAR(SYSDATE,'SS')) AS NUM_SEGUNDOS   
FROM DUAL;

SELECT TO_CHAR(SYSDATE,'SSSSS') FROM DUAL;

SELECT (SYSDATE- TRUNC(SYSDATE))243600
FROM DUAL;

SELECT SYSDATE , TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI:SS'),TO_CHAR(TRUNC(SYSDATE),'DD/MM/YYYY HH24:MI:SS')
FROM DUAL;

--- EXPLIQUEMOS EL DECODE
-- DECODE (COLUMNA O CALCULO, VALOR-1,RESULTADO-1,....VALOR-N,RESULTADO-N,VALOR_DEFECTO)
SELECT DNAME, LOC, DECODE(LOC, 'SEVILLA','VECINO','DALLAS','MAVERICK', 'NEW YORK', 'KNICKS','CHICAGO', 'BULLS','ALGO DISTINTO')
FROM DEPT;


SELECT ENAME, SAL, DECODE(SAL, 800,'COBRO UNA MIERDA',950,'COBRO UNA MIERDA PERO NO SOY EL POBRE', 'COBRA BIEN')
FROM EMP;


SELECT ENAME, DEPTNO,SAL, DECODE(DEPTNO, 10,SAL+500,20, SAL+300, SAL) AS NUEVO_SALARIO
FROM EMP;

SELECT ENAME, COMM, DECODE(COMM, NULL,'NO','SI') AS VENDEDOR
FROM EMP;

SELECT ENAME, COMM, DECODE(NVL(COMM,-1), -1,'NO','SI') AS VENDEDOR
FROM EMP;