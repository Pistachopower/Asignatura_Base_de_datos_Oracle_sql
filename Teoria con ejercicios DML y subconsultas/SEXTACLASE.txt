/*
TO_CHAR
TO_NUMBER
TO_DATE

SELECT TO_CHAR(33), TO_NUMBER('33'), TO_DATE('12/09/1907','DD/MM/YYYY'),
       TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(SYSDATE,'YY'),TO_CHAR(SYSDATE,'WW'),TO_CHAR(SYSDATE,'DD'),TO_CHAR(SYSDATE,'ddd'),
       TO_CHAR(SYSDATE,'mm/yyyy'), '01/'||TO_CHAR(SYSDATE,'mm/yyyy')
FROM DUAL;
*/
SELECT *
FROM ALUMNOS
WHERE TO_CHAR(FECNAC,'MM') = '08';

________________________________________
-- OBTENER LOS CURSOS QUE TIENEN MÁS DE 10 ALUMNOS Y QUE CONTENGA ALUMNOS CUYO NOMBRE CONTENGA LA LETRA A
-- MOSTRAR EL NOMBRE DEL CURSO, EL NUMERO DE ALUMNOS Y ORDENA DESCENDENTEMENTE POR EL NOMBRE.
SELECT CURSO, COUNT(*)
FROM ALUMNOS
WHERE UPPER(NOMBRE) LIKE '%A%'
GROUP BY CURSO
HAVING COUNT(*) >=10 
ORDER BY CURSO DESC;


-- Obtener los nombres que se encuentran repetidos.
select nombre, count(codigo)
from alumnos
group by nombre
having count(codigo)>=2;

-- Obtener el nombre y la fecha de nacimiento de los alumnos que son de 1DAW,
-- que son mayores que francisca maria de SEGUNDO de DAM y que tienen una E en su nombre.
V_EDAD_FM_2DAM
SELECT EDAD
FROM ALUMNOS
WHERE UPPER(CURSO) ='2DAM'
AND UPPER(NOMBRE) = 'FRANCISCA MARIA';

--
SELECT *
FROM ALUMNOS
WHERE UPPER(CURSO) ='1DAW'
AND UPPER(NOMBRE) LIKE '%E%'
AND EDAD >= V_EDAD_FM_2DAM;

SELECT NOMBRE, FECNAC
FROM ALUMNOS
WHERE UPPER(CURSO) ='1DAW'
AND UPPER(NOMBRE) LIKE '%E%'
AND EDAD >= (SELECT EDAD
             FROM ALUMNOS
             WHERE UPPER(CURSO) ='2DAM'
             AND UPPER(NOMBRE) = 'FRANCISCA MARIA'
             );


-- OBTENER LOS ALUMNOS QUE SON MAYORES (UTILIZANDO LA EDAD) QUE EL MAYOR DE LOS JAIMES.
-- Y QUE NO ESTAN EN LA MISMA CLASE QUE FRANCISCA MARIA
V_EDAD_JAIME_MAYOR
CURSO DE FRANCISCA MARIA


SELECT *
FROM ALUMNOS
WHERE EDAD >= V_EDAD_JAIME_MAYOR
AND CURSO <> CURSO DE FRANCISCA MARIA;

V_EDAD_JAIME_MAYOR
SELECT MAX(EDAD) FROM ALUMNOS WHERE UPPER(NOMBRE)= 'JAIME';

CURSO DE FRANCISCA MARIA

SELECT UPPER(CURSO)
FROM ALUMNOS
WHERE UPPER(NOMBRE) = 'FRANCISCA MARIA';


SELECT *
FROM ALUMNOS
WHERE EDAD >= (SELECT MAX(EDAD) FROM ALUMNOS WHERE UPPER(NOMBRE)= 'JAIME')
AND UPPER(CURSO) <> (SELECT UPPER(CURSO) FROM ALUMNOS WHERE UPPER(NOMBRE) = 'FRANCISCA MARIA');