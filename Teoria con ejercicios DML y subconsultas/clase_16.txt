--- 38. DEVUELVE UN LISTADO CON LOS CLIENTES QUE HAN REALIZADO ALGUN PEDIDO 
--- Y NO HAN REALIZADO NINGÚN PAGO.

SELECT *
FROM CLIENTES C, PEDIDOS P
WHERE C.CODIGOCLIENTE = P.CODIGOCLIENTE
AND C.CODIGOCLIENTE NOT IN (SELECT PA.CODIGOCLIENTE FROM PAGOS PA);

SELECT DISTINCT C.CODIGOCLIENTE, PA.CODIGOCLIENTE
FROM CLIENTES C, PEDIDOS P, PAGOS PA
WHERE C.CODIGOCLIENTE = P.CODIGOCLIENTE
AND C.CODIGOCLIENTE = PA.CODIGOCLIENTE(+)
AND PA.CODIGOCLIENTE IS NULL;


SELECT * FROM CLIENTES C
WHERE C.CODIGOCLIENTE IN(   SELECT C.CODIGOCLIENTE
                            FROM CLIENTES C, PEDIDOS P
                            WHERE C.CODIGOCLIENTE = P.CODIGOCLIENTE
                            MINUS
                            SELECT PA.CODIGOCLIENTE 
                            FROM PAGOS PA
                            );

SELECT *
FROM CLIENTES C, PEDIDOS P
WHERE C.CODIGOCLIENTE = P.CODIGOCLIENTE;
AND NOT EXISTS (SELECT PA.CODIGOCLIENTE FROM PAGOS PA WHERE PA.CODIGOCLIENTE = C.CODIGOCLIENTE);



--- PARA IVAN
SELECT *
FROM PAGOS PA, (SELECT C.* FROM CLIENTES C, PEDIDOS P
                WHERE C.CODIGOCLIENTE = P.CODIGOCLIENTE) CON_PEDIDO
WHERE CON_PEDIDO.CODIGOCLIENTE = PA.CODIGOCLIENTE(+)
AND PA.CODIGOCLIENTE IS NULL;


--74 Devuelve las oficinas donde no trabajan ninguno de los empleados 
-- que hayan sido los representantes de ventas de algún cliente 
-- que haya realizado la compra de algún producto de la gama Frutales.
SELECT O.*
FROM OFICINAS O
WHERE O.CODIGOOFICINA NOT IN
                            (SELECT DISTINCT E.CODIGOOFICINA
                             FROM CLIENTES C, PEDIDOS P, DETALLEPEDIDOS DP, PRODUCTOS PR, EMPLEADOS E
                             WHERE C.CODIGOCLIENTE = P.CODIGOCLIENTE
                             AND P.CODIGOPEDIDO =DP.CODIGOPEDIDO 
                             AND DP.CODIGOPRODUCTO=PR.CODIGOPRODUCTO 
                             --AND UPPER(E.PUESTO) ='REPRESENTANTE VENTAS'
                             AND UPPER(PR.GAMA)='FRUTALES'
                             AND C.CODIGOEMPLEADOREPVENTAS = E.CODIGOEMPLEADO);


